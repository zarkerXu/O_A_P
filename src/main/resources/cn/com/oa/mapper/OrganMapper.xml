<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="cn.com.oa.mapper.OrganMapper" >
<resultMap id="Organ" type="cn.com.oa.model.Organ">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Nov 20 17:32:57 CST 2015.
    -->
    <id column="id" jdbcType="VARCHAR" property="id" />
    <result column="uid" jdbcType="VARCHAR" property="uid" />
    <result column="name" jdbcType="VARCHAR" property="name" />
    <result column="value" jdbcType="VARCHAR" property="value" />
    <result column="sort" jdbcType="INTEGER" property="sort" />
    <result column="type" jdbcType="INTEGER" property="type"/> 
  </resultMap>
  
   
    <select id="selectone" parameterType="String" resultType="Organ">
              select o.id,o.sort,o.uid,o.name,(select group_concat(name order by level) from sys_organization where FIND_IN_SET(id,o.value)) departmentName,(select group_concat(id order by level) from sys_organization where FIND_IN_SET(id,o.value)) value from sys_u_organ o where id=#{id};
    </select>
  
   <select id="findalldepartmentnames" parameterType="String" resultType="Organization">
 		 select id,name from sys_organization where  FIND_IN_SET(id,#{value})
    </select>
    <select id="select" parameterType="Organ"  resultType="Organ">
    select o.id,o.sort,o.uid,o.name,(select group_concat(name order by level) 
    from sys_organization where FIND_IN_SET(id,o.value)) departmentName,
    (select group_concat(id order by level) from sys_organization where FIND_IN_SET(id,o.value)) value from sys_u_organ o
     where uid=#{uid} and type=#{type} order by sort;
    </select>

    <insert id="insert" parameterType="Organ">
      insert into sys_u_organ(id,uid,name,value,sort,type) values(#{id},#{uid,jdbcType=VARCHAR},#{name,jdbcType=VARCHAR},#{value,jdbcType=VARCHAR},#{sort},#{type})
    </insert>
    
    <delete id="delete" parameterType="String">
       delete from sys_u_organ where id =#{id}
    </delete> 
    <update id="update" parameterType="Organ">
    update sys_u_organ
    <set>
    <if test="id !=null and id!=''">
    id=#{id},
    </if>
    <if test="uid !=null and uid !=''">
    uid=#{uid},
    </if>
    <if test="name !=null and name !=''">
    name=#{name},
    </if>
     <if test="value !=null and value !=''">
    value=#{value},
    </if>
     <if test="sort !=null and sort !=''">
    sort=#{sort}
    </if>
    <if test="type !=null and type !=''">
    type=#{type}
    </if>
    </set>
    where id=#{id}
    </update>
    
  </mapper>